{
#   # Set the ACME DNS challenge provider to use Cloudflare for all sites
  acme_dns cloudflare {env.CLOUDFLARE_API_TOKEN}
  ech tmak2002.de
}

(mutual_tls) {
  tls {
    protocols tls1.3
    client_auth {
      mode require_and_verify
      trusted_ca_cert_file /etc/caddy/rootCA.enc.pem
    }
  }
}

pihole.tmak2002.de {
  redir / /admin
  reverse_proxy pihole:80
}

syncthing.tmak2002.de {
  reverse_proxy syncthing:8384
}

vault.tmak2002.de {
  encode zstd gzip
  reverse_proxy vaultwarden:80
}

links.tmak2002.de {
  reverse_proxy linkding:9090
}